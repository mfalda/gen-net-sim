library("netsim")

cat("\n*** simulatenet ***\n\n")
cat("act.fun ...\n")
ris <- simulatenet(N=5, act.fun="linear", times=seq(1,5))
cat("ok\n\n")
cat("-----------------------------------\n")
cat("f.pr.and ...\n")
ris <- simulatenet(N=5, f.pr.and="1 / (1 + e ^ (-10 * (x - 0.5)))", times=seq(1,5))
cat("ok\n\n")
cat("-----------------------------------\n")
cat("geometric ...\n")
ris <- simulatenet(N=5, connectivity="geometric", times=seq(1,5))
cat("ok\n\n")
cat("-----------------------------------\n")
cat("itera & save ...\n")
ris <- simulatenet(N=5, save=TRUE, itera=5, times=seq(1,10))
cat("ok\n\n")
cat("-----------------------------------\n")
cat("MTM ...\n")
ris <- simulatenet(N=5, connectivity="MTM", times=seq(1,5))
cat("ok\n\n")
cat("-----------------------------------\n")
cat("ODE ...\n")
ris <- simulatenet(N=5, method="rkf45", times=seq(1,5))
cat("ok\n\n")
cat("-----------------------------------\n")
cat("INdregree ...\n")
ris <- simulatenet(N=5, INdegree="out", times=seq(1,5))
cat("ok\n\n")
cat("-----------------------------------\n")
cat("random ...\n")
ris <- simulatenet(N=5, connectivity="random", times=seq(1,5))
cat("ok\n\n")
cat("-----------------------------------\n")
cat("save ...\n")
ris <- simulatenet(N=5, save=TRUE, times=seq(1,5))
cat("ok\n\n")
cat("-----------------------------------\n")
cat("scale free ...\n")
ris <- simulatenet(N=5, connectivity="scale free", times=seq(1,5))
cat("ok\n\n")
cat("-----------------------------------\n")
cat("parametri esterni ...\n")
ris <- simulatenet(N=5, lambda=c(1,2,3,4,5), alpha=c(10,20,30,40,50), beta=c(11,22,33,44,55), Xmin=c(101,202,303,404,505), Xmax=c(121,222,323,424,525), x0=c(111,212,313,414,515), params=c(0,0,0,0,0,0),save=T)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("parametro Xmin esterno ...\n")
ris <- simulatenet(N=5, connectivity="scale free", method="rkf45", Xmin=rep(0,5), params=c(2,2,2,0,0,1))
cat("ok\n\n")
cat("-----------------------------------\n")
cat("parametro Xmin uniforme ...\n")
ris <- simulatenet(N=5, connectivity="scale free", method="rkf45", params=c(2,2,2,1,0,1))
cat("ok\n\n")
cat("-----------------------------------\n")
#~ cat("Mille geni ...\n")
#~ ris1000 <- simulatenet(N=1000, connectivity="scale free", times=seq(1,5))
#~ cat("ok\n\n")
#~ cat("-----------------------------------\n")
cat("-----------------------------------\n")
cat("\n*** simulateprofiles ***\n\n")

Dati <- matrix(c(1.793561,1.793561,1.793561,1.793561,1.793561,4.239327,4.239327,4.239327,4.239327,4.239327,1.031338,1.031338,1.031338,1.031338,1.031338,1.789676,1.789676,1.789676,1.789676,1.789676,7.767749,7.767749,7.767749,7.767749,7.767749), 5, 5)

pesi <- matrix(c(0,0,0,-1,0,-1,0,-1,0,0,0,-1,0,0,-1,-1,0,0,0,0,0,0,-1,0,0), 5, 5)

lambda <-c(1.1056752,0.9747519,1.0007163,1.0061211,1.1354204)

alpha <- c(9.869912,9.955962,10.056057,9.922354,9.950865)

rules <- list(c(5), c(5), c(5), c(5), c(1))

beta <- c(0.4934634,0.4930697,0.4926102,0.4976155,0.4905647)

N<-dim(Dati)[1]
times<-seq(1,5)

cat("regole come lista ...\n")
ris <- simulateprofiles(weights=pesi, Rules=rules, lambda=lambda, alpha=alpha, beta=beta, times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("act.fun ...\n")
ris <- simulateprofiles(weights=pesi, Rules=rules, act.fun="linear", times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("ext.fun ...\n")
ext.W<-matrix(0, N, 2)
ext.W[2,1]<-ext.W[3,1]<-ext.W[2,2]<-1
ris <- simulateprofiles(weights=pesi, lambda=lambda, alpha=alpha, beta=beta, EXT.IN=ext.W, EXT.FUN=list("sin(x)", "if(x < 1, 0, x - 1)"), times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("f.pr.and ...\n")
ris <- simulateprofiles(weights=pesi, lambda=lambda, alpha=alpha, beta=beta, f.pr.and="1 / (1 + e ^ (-10 * (x - 0.5)))", times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("itera & save ...\n")
ris <- simulateprofiles(weights=pesi, itera=10, save=TRUE, times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("tutti i ko ...\n")
ris <- simulateprofiles(weights=pesi, lambda=lambda, alpha=alpha, beta=beta, ko.experim=c(0), times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("alcuni ko ...\n")
ris <- simulateprofiles(weights=pesi, lambda=lambda, alpha=alpha, beta=beta, ko.experim=c(1,3,5), save=TRUE, times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("ODE ...\n")
ris <- simulateprofiles(weights=pesi, lambda=lambda, alpha=alpha, beta=beta, method="rkf45", times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("regole casuali ...\n")
ris <- simulateprofiles(weights=pesi, lambda=lambda, alpha=alpha, beta=beta, times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("save ...\n")
ris <- simulateprofiles(weights=pesi, lambda=lambda, alpha=alpha, beta=beta, save=TRUE, times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("da SN ...\n")
net<-simulatenet(10, connectivity="geometric", save=TRUE, itera=5)
ris <- simulateprofiles(weights=NULL, method="rkf45", params=c(4,4,4,4,4,4), itera=5, times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("da SN modulate con distribuzione uniforme tra 0 e 1 ...\n")
net<-simulatenet(10, connectivity="geometric", save=TRUE, itera=5)
ris <- simulateprofiles(weights=NULL, method="rkf45", lambda=c(0,1), alpha=c(0,1), beta=c(0,1), Xmin=c(0,1), Xmax=c(0,1), x0=c(0,1), params=c(8,8,8,8,8,1), itera=5, times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("da SN modulate con distribuzione normale (0,1) ...\n")
net<-simulatenet(10, connectivity="geometric", save=TRUE, itera=5)
ris <- simulateprofiles(weights=NULL, method="rkf45", lambda=c(0,1), alpha=c(0,1), beta=c(0,1), Xmin=c(0,1), Xmax=c(0,1), x0=c(0,1), params=c(9,9,9,9,9,1), itera=5, times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("da SN modulate con distribuzione log-normale (0,1) ...\n")
net<-simulatenet(10, connectivity="geometric", save=TRUE, itera=5)
ris <- simulateprofiles(weights=NULL, method="rkf45", lambda=c(0,1), alpha=c(0,1), beta=c(0,1), Xmin=c(0,1), Xmax=c(0,1), x0=c(0,1), params=c(10,10,10,10,10,1), itera=5, times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("da SN con regole di SN ...\n")
ris <- simulateprofiles(weights=NULL, Rules=NULL, method="rkf45", params=c(4,4,4,4,4,4), itera=5, times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("da SN con ko ...\n")
ris <- simulateprofiles(weights=NULL, method="rkf45", ko.experim=c(1,3,5), params=c(4,4,4,4,4,4), itera=5, times=times)
cat("ok\n\n")
cat("-----------------------------------\n")
#~ cat("Mille geni ...\n")
#~ ris <- simulateprofiles(weights=ris1000[[1]][[2]], method="rkf45", times=times)
#~ cat("ok\n\n")
#~ cat("-----------------------------------\n")
cat("parametri esterni ...\n")
ris <- simulateprofiles(weights=pesi, Rules=rules, act.fun="linear", times=times, lambda=c(1,2,3,4,5), alpha=c(10,20,30,40,50), beta=c(11,22,33,44,55), Xmin=c(101,202,303,404,505), Xmax=c(121,222,323,424,525), x0=c(111,212,313,414,515), params=c(0,0,0,0,0,0),save=T)
cat("ok\n\n")
cat("parametri esterni modulati con distribuzione uniforme tra 0 e 1 ...\n")
ris <- simulateprofiles(weights=pesi, Rules=rules, act.fun="linear", times=times, lambda=c(1,2,3,4,5, 0, 1), alpha=c(10,20,30,40,50, 0, 1), beta=c(11,22,33,44,55, 0, 1), Xmin=c(101,202,303,404,505, 0, 1), Xmax=c(121,222,323,424,525, 0, 1), x0=c(0, 1), params=c(5,5,5,5,5,1),save=T)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("parametri esterni modulati con distribuzione normale (0,1) ...\n")
ris <- simulateprofiles(weights=pesi, Rules=rules, act.fun="linear", times=times, lambda=c(1,2,3,4,5, 0, 1), alpha=c(10,20,30,40,50, 0, 1), beta=c(11,22,33,44,55, 0, 1), Xmin=c(101,202,303,404,505, 0, 1), Xmax=c(121,222,323,424,525, 0, 1), x0=c(0, 1), params=c(6,6,6,6,6,1),save=T)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("parametri esterni modulati con distribuzione log-normale (0,1) ...\n")
ris <- simulateprofiles(weights=pesi, Rules=rules, act.fun="linear", times=times, lambda=c(1,2,3,4,5, 0, 1), alpha=c(10,20,30,40,50, 0, 1), beta=c(11,22,33,44,55, 0, 1), Xmin=c(101,202,303,404,505, 0, 1), Xmax=c(121,222,323,424,525, 0, 1), x0=c(0, 1), params=c(7,7,7,7,7,1),save=T)
cat("ok\n\n")
cat("-----------------------------------\n")
cat("parametro Xmin esterno ...\n")
ris <- simulateprofiles(weights=pesi, Rules=rules, act.fun="linear", times=times, Xmin=rep(0,5), params=c(2,2,2,0,0,1))
cat("ok\n\n")
cat("-----------------------------------\n")
cat("parametro Xmin uniforme ...\n")
ris <- simulateprofiles(weights=pesi, Rules=rules, act.fun="linear", times=times, params=c(2,2,2,1,0,1))
cat("ok\n\n")
cat("-----------------------------------\n")
cat("TEST COMPLETATI CON SUCCESSO\n")